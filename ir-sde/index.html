<!--
  Copyright 2018 The Distill Template Authors
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at
       http://www.apache.org/licenses/LICENSE-2.0
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<!doctype html>

<style>
.base-grid,
.n-header,
.n-byline,
.n-title,
.n-article,
.n-footer {
    display: grid;
    justify-items: stretch;
    grid-template-columns: [screen-start] 8px [page-start kicker-start text-start gutter-start middle-start] 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr [text-end page-end gutter-end kicker-end middle-end] 8px [screen-end];
    grid-column-gap: 8px;
}

.grid {
  display: grid;
  grid-column-gap: 8px;
}

@media(min-width: 768px) {
    .base-grid,
    .n-header,
    .n-byline,
    .n-title,
    .n-article,
    .n-footer {
        display: grid;
        justify-items: stretch;
        grid-template-columns: [screen-start] 1fr [page-start kicker-start middle-start text-start] 45px 45px 45px 45px 45px 45px 45px 45px [ kicker-end text-end gutter-start] 45px [middle-end] 45px [page-end gutter-end] 1fr [screen-end];
        grid-column-gap: 16px;
    }

    .grid {
        grid-column-gap: 16px;
    }
}

@media(min-width: 1000px) {
    .base-grid,
    .n-header,
    .n-byline,
    .n-title,
    .n-article,
    .n-footer {
        display: grid;
        justify-items: stretch;
        grid-template-columns: [screen-start] 1fr [page-start kicker-start] 50px [middle-start] 50px [text-start kicker-end] 50px 50px 50px 50px 50px 50px 50px 50px [text-end gutter-start] 50px [middle-end] 50px [page-end gutter-end] 1fr [screen-end];
        grid-column-gap: 16px;
    }

    .grid {
        grid-column-gap: 16px;
    }
}

@media (min-width: 1180px) {
    .base-grid,
    .n-header,
    .n-byline,
    .n-title,
    .n-article,
    .n-footer {
        display: grid;
        justify-items: stretch;
        grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
        grid-column-gap: 32px;
    }
    .grid {
        grid-column-gap: 32px;
    }

}

.base-grid {
  grid-column: screen;
}

/* default grid column assignments */
.n-title > *  {
  grid-column: text;
}

.n-article > *  {
  grid-column: text;
}

.n-title {
    padding: 4rem 0 0.5rem;
}

.l-page {
    grid-column: page;
}

.l-article {
    grid-column: text;
}

p {
  margin-top: 0;
  margin-bottom: 1em;
}


.pixelated {
    image-rendering: pixelated;
}

strong {
    font-weight: 600;
}

/*------------------------------------------------------------------*/
/* title */
.n-title h1 {
    font-family: "Barlow",system-ui,Arial,sans-serif;
/*    color:#082333;*/
    color: rgb(250,250,250);
    grid-column: text;
    font-size: 18px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
    text-align: center;
}

.n-title h2 {
    color: rgb(250,250,250);
    font-weight: 550;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
    text-align: center;
}

@media (min-width: 768px) {
    .n-title h1 {
        font-size: 35px;
    }
}


.n-byline {
  contain: style;
  overflow: hidden;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  font-size: 0.8rem;
  line-height: 1.8em;
  padding: 1.5rem 0;
  min-height: 1.8em;
}

.n-byline .byline {
  grid-column: text;
}

.byline {
    grid-template-columns: 1fr 1fr 1fr 1fr;
}

.grid {
    display: grid;
    grid-column-gap: 8px;
}

@media (min-width: 768px) {
.grid {
    grid-column-gap: 16px;
}
}

.n-byline p {
  margin: 0;
}

.n-byline h3 {
    font-size: 0.6rem;
    font-weight: 400;
    color: rgba(0, 0, 0, 0.5);
    margin: 0;
    text-transform: uppercase;
}
.n-byline .authors-affiliations {
  grid-column-end: span 2;
  grid-template-columns: 1fr 1fr;
}

ul.authors {
    list-style-type: none;
    padding: 0;
    margin: 0;
    text-align: center;
}
ul.authors li {
    padding: 0 0.5rem;
    display: inline-block;
}

ul.authors sup {
    color: rgb(206,206,206);
}

ul.authors.affiliations  {
    margin-top: 0.5rem;
}

ul.authors.affiliations > li > a{
    color: rgb(186,186,206, 0.8);
    text-decoration:none; 
}

.authors.bottom > li > a {
    text-decoration:none;
    color: inherit;
    color: rgb(255,255,255);
    font-size: 14px;
}

.authors.bottom > li > a:hover {
    text-decoration:none;
    color: inherit;
    color: rgb(255,255,255);
/*    text-decoration:underline;*/
    transition: 0.s;

    padding-bottom: 0px;
    border-bottom: 0px solid #fff;
}

ul.authors.affiliations > li > a:hover {
    text-decoration:none; 
    color: rgb(206,206,226, 1);
    padding-bottom: 0px;
    border-bottom: 0px solid #fff;
}

.n-title, .n-byline{
  background:  #004050;
  color: rgb(210,210,210);
  font-family: Quando;
  font-weight: 300;
  width: 100%;
}

p > a, .authors > li > a {
    text-decoration:none;
    color: inherit;
    color: rgb(200,200,200);
}

p > a:hover, .authors > li > a:hover {
    text-decoration:none;
    color: inherit;
    color: rgb(255,255,255);
/*    text-decoration:underline;*/
    transition: 0.2s;

    padding-bottom: 1px;
    border-bottom: 1px solid #fff;
}

div.overlines {
    border-top: 1px solid rgba(0, 0, 0, 0.1); 
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}



</style>
<head>
    <title>IR-SDE</title>
    <script src="template.v2.js"></script>
    <meta property="og:title" content="Image Restoration with Mean-Reverting Stochastic Differential Equations">
    <meta property="og:type" content="website">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        inlineMath: [['$','$']]
      }
    });
    </script>
    <script type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
    <meta charset="utf8">
</head>

<body>
  <div class="n-title">
   <h1>
    Image Restoration with Mean-Reverting Stochastic Differential Equations
   </h1>
   <h2 style="text-align: center">
    &mdash; IR-SDE &mdash;
   </h2>
   <!-- <p style="text-align: center"> ICLR 2023 spotlight </p> -->
   <p style="text-align: center"> [<a href = "https://arxiv.org/abs/2301.11699"><b>Paper</b></a>]  [<a href = "https://github.com/Algolzw/image-restoration-sde"><b>Code</b></a>] </p>
  </div>
  <div class="n-byline">
   <div class="byline">
    <ul class="authors">
     <li>
      <a href = "https://algolzw.github.io/">Ziwei Luo</a>
     </li>
     <li>
      <a href = "https://www.fregu856.com/">Fredrik K. Gustafsson</a>
     </li>
     <li>
      <a href = "https://zz.zabemon.com/">Zheng Zhao</a>
     </li>
     <li>
      <a href = "https://jsjol.github.io/">Jens Sjölund</a>
     </li>
     <li>
      <a href = "https://user.it.uu.se/~thosc112/index.html">Thomas B. Schön</a>
     </li>
    </ul>
    <ul class="authors affiliations">
     <li>
      <a href = "https://www.it.uu.se/">Department of Information Technology, Uppsala University</a>
     </li>
    </ul>
   </div>
  </div>
  <d-article>
    <figure  style="grid-column: text">
        <img src="images/overview.png" style="width: 100%;display: block; margin-left: auto; margin-right: auto;"/>
        <figcaption >  <b>An overview of our proposed construction</b>: A mean-reverting SDE <b>$dx = \theta_t \, (\mu - {x}) dt + \sigma_t dw$</b> is used for image restoration. The SDE models the degradation process from a high-quality image $x(0)$ to its low-quality counterpart $\mu$, by diffusing $x(0)$ towards a noisy version $\mu + \epsilon$ of the low-quality image. By simulating the corresponding reverse-time SDE, high-quality images can then be restored.  </figcaption>
        <img src="images/results.png" style="width: 100%; margin-top: 1rem;display: block; margin-left: auto; margin-right: auto;"/>
            <figcaption >  <b>IR-SDE works well on various problems, <em style="color: #e67300;">the only change required for each task is to replace the dataset!</em> </b></figcaption>
    </figure>
    <h3 style="text-align: center;" >Summary</h3>
    <p style="text-align: justify;">
      We present a stochastic differential equation (SDE) approach for general-purpose image restoration. The key construction consists in a mean-reverting SDE that transforms a high-quality image into a degraded counterpart as a mean state with fixed Gaussian noise. Then, by simulating the corresponding reverse-time SDE, we are able to restore the origin of the low-quality image without relying on any task-specific prior knowledge. Crucially, the proposed mean-reverting SDE has a closed-form solution, allowing us to compute the ground truth time-dependent score and learn it with a neural network. Moreover, we propose a maximum likelihood objective to learn an optimal reverse trajectory which stabilizes the training and improves the restoration results. In the experiments, we show that our proposed method achieves highly competitive performance in quantitative comparisons on image deraining, deblurring, and denoising, setting a new state-of-the-art on two deraining datasets. Finally, the general applicability of our approach is further demonstrated via qualitative results on image super-resolution, inpainting, and dehazing. 
    </p>

    <div class="overlines">
        <h4 style="text-align: center;">Forward SDE for Image Degradation</h3>
        <p style="text-align: center;">
          <b>$dx = \theta_t \, (\mu - {x}) dt + \sigma_t dw$</b>
        </p>

        <h4 style="text-align: center;">Reverse-Time SDE for Image Restoration</h3>
        <p style="text-align: center;">
          <b>$dx = \big[ \theta_t \, (\mu - x) - \sigma_t^2 \, \nabla_x \log p_t(x) \big] dt + \sigma_t d\hat{w}$</b>
        </p>
    </div>

    <h3 style="text-align: center;">Illustration of Image Restoration Process</h3>
    <p>We experimentally evaluate our proposed IR-SDE method on several popular image restoration tasks: image deraining, deblurring, denoising, super-resolution, inpainting, and dehazing. <strong><em>Our method doesn't need to known any prior of the degradation, and the only change required for each task was to change the dataset.</em></strong> Below we visually illustrate the reverse-time process of the IR-SDE on different tasks.</p>

    <h4>Image deraining</h4>
    <div style="text-align: center;">
        <video controls loop width="768" height="432" style="width: 100%;display: block; margin-left: auto; margin-right: auto;">
        <source src="images/derain.mp4" type="video/mp4">
        </video>
        <figcaption style="display:flex; justify-content: center"> <b>Image Deraining</b> </figcaption>
    </div>

    <h4>Image deblurring</h4>
    <div style="text-align: center;">
        <video controls loop width="768" height="432" style="width: 100%;display: block; margin-left: auto; margin-right: auto;">
        <source src="images/deblur.mp4" type="video/mp4">
        </video>
        <figcaption style="display:flex; justify-content: center"> <b>Image Deblurring</b>  </figcaption>
    </div>

    <h4>Image denoising</h4>
    <div style="text-align: center;">
        <video controls loop width="768" height="432" style="width: 100%;display: block; margin-left: auto; margin-right: auto;">
        <source src="images/denoising.mp4" type="video/mp4">
        </video>
        <figcaption style="display:flex; justify-content: center"> <b>Image Denoising</b>  </figcaption>
    </div>

    <h4>Image super-resolution</h4>
    <div style="text-align: center;">
        <video controls loop width="768" height="432" style="width: 100%;display: block; margin-left: auto; margin-right: auto;">
        <source src="images/super-resolution.mp4" type="video/mp4">
        </video>
        <figcaption style="display:flex; justify-content: center"> <b>Image Super-Resolution</b> </figcaption>
    </div>

    <h4>Image inpainting</h4>
    <div style="text-align: center;">
        <video controls loop width="768" height="432" style="width: 100%;display: block; margin-left: auto; margin-right: auto;">
        <source src="images/inpainting.mp4" type="video/mp4">
        </video>
        <figcaption style="display:flex; justify-content: center"> <b>Image Inpainting</b> </figcaption>
    </div>

    <h4>Image dehazing</h4>
    <div style="text-align: center;">
        <video controls loop width="768" height="432" style="width: 100%;display: block; margin-left: auto; margin-right: auto;">
        <source src="images/dehaze.mp4" type="video/mp4">
        </video>
        <figcaption style="display:flex; justify-content: center"> <b>Image Dehazing</b> </figcaption>
    </div>

    <h3 style="text-align: center;">Interpolation</h3>
    <p>With IR-SDE, we can also perform interpolation by letting source image to be $x(0)$ and target image to be $\mu$, and then simply simulating the forward SDE process.</p>

    <h4>Image Interpolation</h4>
    <div style="text-align: center;">
        <video controls loop width="768" height="432" style="width: 100%;display: block; margin-left: auto; margin-right: auto;">
        <source src="images/interpolation.mp4" type="video/mp4">
        </video>
        <figcaption style="display:flex; justify-content: center"> <b>Image Interpolation</b> </figcaption>
    </div>


    <h3>Related Projects</h3>
    <ul>
      <li>This template is built upon <a href="https://iterative-refinement.github.io/">SR3: Image Super-Resolution via Iterative Refinement</a>.</li>
    </ul>
      

    <h3>Citation</h3>
    
    <code>
      @article{luo2023image,
      <div style="padding-left: 5%; margin: 0">
        title={Image Restoration with Mean-Reverting Stochastic Differential Equations},<br/>
        author={Luo, Ziwei and Gustafsson, Fredrik K and Zhao, Zheng and Sj{\"o}lund, Jens and Sch{\"o}n, Thomas B},<br/>
        journal={arXiv preprint arXiv:2301.11699},<br/>
        year={2023}<br/>
      </div>
      }<br/>
    </code>
<span style="margin-bottom: 10%"></span>
</d-article>

<div class="n-byline">
   <div class="byline">
    <ul class="authors bottom">
     <li>
      <a>Ziwei Luo</a>
     </li>
     <li>
      <a>Fredrik K. Gustafsson</a>
     </li>
     <li>
      <a>Zheng Zhao</a>
     </li>
     <li>
      <a>Jens Sjölund</a>
     </li>
     <li>
      <a>Thomas B. Schön</a>
     </li>
     <li>
        &bull; &emsp; <a>2023</a>
     </li>
    </ul>
   </div>
  </div>

</body>
